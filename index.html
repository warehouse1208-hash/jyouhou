<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全商情報処理検定 小テスト</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }
        .container {
            background: #fff;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 700px;
            text-align: center;
        }
        h1 {
            color: #0056b3;
        }
        #setup, #quiz, #results {
            margin-top: 20px;
        }
        #question {
            font-size: 1.2em;
            margin-bottom: 20px;
            text-align: left;
            padding: 15px;
            background-color: #e9f5ff;
            border-left: 5px solid #0056b3;
            border-radius: 5px;
        }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: 1px solid #ccc;
            background-color: #f9f9f9;
            color: #333;
            cursor: pointer;
            font-size: 1em;
            border-radius: 5px;
            transition: background-color 0.3s, border-color 0.3s;
            text-align: left;
        }
        .btn:hover {
            background-color: #e9e9e9;
            border-color: #999;
        }
        .btn.correct {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .btn.incorrect {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        .feedback {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            text-align: left;
        }
        #explanation {
            background-color: #fff3cd;
            border: 1px solid #ffeeba;
        }
        #hint-container {
            margin-top: 15px;
            text-align: right;
        }
        #hint-btn {
            background-color: #007bff;
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            border: none;
        }
        #hint-text {
            display: none;
            margin-top: 10px;
            padding: 10px;
            background-color: #f0f0f0;
            border-radius: 5px;
            text-align: left;
        }
        select, button {
            padding: 10px;
            font-size: 1em;
            margin: 5px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        #start-btn, #next-btn, #restart-btn {
            background-color: #28a745;
            color: white;
            cursor: pointer;
            width: 50%;
            margin-top: 20px;
        }
        #next-btn, #restart-btn {
            background-color: #007bff;
        }
        #results h2 {
            color: #28a745;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>全商情報処理検定<br>重要語句 小テスト</h1>

    <div id="setup">
        <h2>設定</h2>
        <p>部門と級を選択してください。</p>
        <select id="department">
            <option value="programming">プログラミング部門</option>
            <option value="business">ビジネス情報部門</option>
        </select>
        <select id="level">
            <option value="3">3級</option>
            <option value: "2">2級</option>
            <option value="1">1級</option>
        </select>
        <button id="start-btn">テスト開始</button>
    </div>

    <div id="quiz" style="display:none;">
        <h2 id="question-counter"></h2>
        <div id="question"></div>
        <div id="options-container"></div>
        <div id="hint-container">
            <button id="hint-btn">ヒントを見る</button>
            <div id="hint-text"></div>
        </div>
        <div class="feedback">
            <div id="explanation" style="display:none;"></div>
        </div>
        <button id="next-btn" style="display:none;">次の問題へ</button>
    </div>

    <div id="results" style="display:none;">
        <h2>テスト結果</h2>
        <p id="score"></p>
        <p id="feedback-message"></p>
        <button id="restart-btn">もう一度挑戦する</button>
    </div>
</div>

<script>
    const quizData = [
        // 3級 ビジネス情報
        { department: 'business', level: 3, question: 'CPUの処理速度を表す単位として、適切なものはどれか。', options: ['Hz', 'dpi', 'bps', 'byte'], answer: 'Hz', hint: 'コンピュータの動作の基準となる信号が1秒間に何回発生するかを示す単位です。', explanation: 'CPUの性能を示す指標の一つにクロック周波数があり、その単位としてHz（ヘルツ）が用いられます。dpiは解像度、bpsは通信速度、byteは情報量を表す単位です。' },
        { department: 'business', level: 3, question: 'インターネット上の住所にあたるもので、「https://www...」のように表されるものは何か。', options: ['IPアドレス', 'ドメイン名', 'URL', 'DNS'], answer: 'URL', hint: 'Uniform Resource Locatorの略です。', explanation: 'URLはインターネット上のWebページやファイルの場所を特定するための記述方式です。IPアドレスも住所に例えられますが、数字の羅列で人間には分かりにくいため、URLが一般的に使われます。' },
        // 2級 ビジネス情報
        { department: 'business', level: 2, question: '複数のコンピュータを接続し、データや資源を共有するしくみを何と呼ぶか。', options: ['OS', 'データベース', 'ネットワーク', 'アプリケーション'], answer: 'ネットワーク', hint: '有線や無線で機器同士をつなぎます。', explanation: 'コンピュータネットワークにより、ファイル共有、プリンタ共有、電子メールの送受信などが可能になります。' },
        { department: 'business', level: 2, question: '関係データベースにおいて、特定の1件のデータを識別するための一意な値を持つ項目を何と呼ぶか。', options: ['レコード', 'フィールド', '外部キー', '主キー'], answer: '主キー', hint: '英語ではPrimary Key（プライマリーキー）といいます。', explanation: '主キーを設定することで、データの重複を防ぎ、目的のデータを高速に検索できるようになります。学生番号や社員番号などが主キーの例です。' },
        // 1級 ビジネス情報
        { department: 'business', level: 1, question: 'システムの開発工程で、利用者の要求を定義する最も初期の段階はどれか。', options: ['基本設計', '詳細設計', 'プログラミング', '要件定義'], answer: '要件定義', hint: 'システム化する範囲や、必要な機能を明確にする工程です。', explanation: '要件定義では、利用者がシステムに何を求めているのか（要求）を分析し、実現すべき機能や性能などを具体的に定義します。この後の設計工程の基礎となります。' },
        { department: 'business', level: 1, question: '情報セキュリティの3大要素（CIA）に含まれないものはどれか。', options: ['機密性 (Confidentiality)', '完全性 (Integrity)', '可用性 (Availability)', '信頼性 (Reliability)'], answer: '信頼性 (Reliability)', hint: 'CIAはそれぞれの英単語の頭文字です。', explanation: '情報セキュリティの3大要素は、機密性・完全性・可用性です。機密性は許可された者だけが情報にアクセスできること、完全性は情報が正確で改ざんされていないこと、可用性は必要な時にいつでも情報にアクセスできることを指します。' },
        // 3級 プログラミング
        { department: 'programming', level: 3, question: 'プログラムの中で、特定の処理を何度も繰り返し実行させる制御構造を何と呼ぶか。', options: ['順次実行', '条件分岐', '繰り返し（ループ）', 'サブルーチン'], answer: '繰り返し（ループ）', hint: '「for」や「while」などの命令が使われます。', explanation: '繰り返し構造を用いることで、同じような処理を効率的に記述することができます。' },
        { department: 'programming', level: 3, question: 'プログラムの誤りや欠陥のことを、虫に例えて何と呼ぶか。', options: ['バグ', 'ウイルス', 'エラー', 'フリーズ'], answer: 'バグ', hint: 'この誤りを見つけて修正する作業は「デバッグ」と呼ばれます。', explanation: 'プログラムが意図した通りに動作しない原因となる誤りのことをバグと呼びます。' },
        // 2級 プログラミング
        { department: 'programming', level: 2, question: 'ある処理をひとまとまりの部品として定義し、名前をつけて何度も呼び出せるようにしたものを何と呼ぶか。', options: ['変数', '配列', '関数（手続き）', '定数'], answer: '関数（手続き）', hint: '同じコードを何度も書く手間を省くことができます。', explanation: '関数（または手続き、メソッド、サブルーチン）を利用することで、プログラムの構造が分かりやすくなり、再利用性も高まります。' },
        { department: 'programming', level: 2, question: '「もしAならばBを実行し、そうでなければCを実行する」という処理は、どの制御構造にあたるか。', options: ['順次', '選択（分岐）', '繰り返し', '代入'], answer: '選択（分岐）', hint: '「if文」が代表的な命令です。', explanation: '条件によって処理の流れを変えることを選択（条件分岐）と呼びます。プログラムに判断をさせることができます。' },
        // 1級 プログラミング
        { department: 'programming', level: 1, question: 'データとそれに対する操作を一つにまとめた「オブジェクト」を主体としてプログラムを設計する考え方を何と呼ぶか。', options: ['手続き型プログラミング', '構造化プログラミング', 'オブジェクト指向プログラミング', '関数型プログラミング'], answer: 'オブジェクト指向プログラミング', hint: '現実世界の「モノ」のように、データと振る舞いをセットで考えます。', explanation: 'オブジェクト指向プログラミングは、大規模で複雑なソフトウェアの開発に適した手法です。カプセル化、継承、多様性（ポリモーフィズム）といった特徴があります。' },
        { department: 'programming', level: 1, question: 'プログラムをコンピュータが実行できる機械語に一括して翻訳する方式のソフトウェアを何と呼ぶか。', options: ['インタプリタ', 'コンパイラ', 'アセンブラ', 'デバッガ'], answer: 'コンパイラ', hint: '翻訳（コンパイル）が完了すると、実行ファイルが生成されます。', explanation: 'コンパイラは、人間が書いたソースコードをまとめて機械語に翻訳します。一方、一行ずつ翻訳しながら実行する方式をインタプリタと呼びます。' }
    ];

    let currentQuestions = [];
    let currentQuestionIndex = 0;
    let score = 0;

    const setupEl = document.getElementById('setup');
    const quizEl = document.getElementById('quiz');
    const resultsEl = document.getElementById('results');

    const startBtn = document.getElementById('start-btn');
    const nextBtn = document.getElementById('next-btn');
    const restartBtn = document.getElementById('restart-btn');
    
    const departmentSelect = document.getElementById('department');
    const levelSelect = document.getElementById('level');

    const questionCounterEl = document.getElementById('question-counter');
    const questionEl = document.getElementById('question');
    const optionsContainerEl = document.getElementById('options-container');
    const explanationEl = document.getElementById('explanation');
    const hintBtn = document.getElementById('hint-btn');
    const hintTextEl = document.getElementById('hint-text');

    startBtn.addEventListener('click', startQuiz);
    nextBtn.addEventListener('click', nextQuestion);
    restartBtn.addEventListener('click', () => {
        resultsEl.style.display = 'none';
        setupEl.style.display = 'block';
    });
    hintBtn.addEventListener('click', () => {
        hintTextEl.style.display = 'block';
    });

    function startQuiz() {
        const selectedDepartment = departmentSelect.value;
        const selectedLevel = parseInt(levelSelect.value);

        currentQuestions = quizData.filter(q => q.department === selectedDepartment && q.level === selectedLevel);
        
        if(currentQuestions.length === 0){
            alert('申し訳ありません。選択された条件に合う問題がありません。');
            return;
        }

        currentQuestions = shuffleArray(currentQuestions);
        currentQuestionIndex = 0;
        score = 0;

        setupEl.style.display = 'none';
        resultsEl.style.display = 'none';
        quizEl.style.display = 'block';

        displayQuestion();
    }

    function displayQuestion() {
        resetState();
        const question = currentQuestions[currentQuestionIndex];
        questionCounterEl.textContent = `第 ${currentQuestionIndex + 1} 問 / ${currentQuestions.length} 問`;
        questionEl.textContent = question.question;
        hintTextEl.textContent = `ヒント: ${question.hint}`;

        question.options.forEach(option => {
            const button = document.createElement('button');
            button.innerText = option;
            button.classList.add('btn');
            button.addEventListener('click', selectAnswer);
            optionsContainerEl.appendChild(button);
        });
    }

    function resetState() {
        nextBtn.style.display = 'none';
        explanationEl.style.display = 'none';
        hintBtn.style.display = 'block';
        hintTextEl.style.display = 'none';
        while (optionsContainerEl.firstChild) {
            optionsContainerEl.removeChild(optionsContainerEl.firstChild);
        }
    }

    function selectAnswer(e) {
        const selectedBtn = e.target;
        const correct = selectedBtn.innerText === currentQuestions[currentQuestionIndex].answer;

        if (correct) {
            score++;
            selectedBtn.classList.add('correct');
            explanationEl.innerHTML = `<strong>正解！</strong><br>${currentQuestions[currentQuestionIndex].explanation}`;
        } else {
            selectedBtn.classList.add('incorrect');
            explanationEl.innerHTML = `<strong>不正解...</strong> 正解は「<strong>${currentQuestions[currentQuestionIndex].answer}</strong>」です。<br>${currentQuestions[currentQuestionIndex].explanation}`;
        }

        Array.from(optionsContainerEl.children).forEach(button => {
            if (button.innerText === currentQuestions[currentQuestionIndex].answer) {
                if(!button.classList.contains('correct')) button.classList.add('correct');
            }
            button.disabled = true;
        });

        explanationEl.style.display = 'block';
        hintBtn.style.display = 'none';
        hintTextEl.style.display = 'none';

        if (currentQuestions.length > currentQuestionIndex + 1) {
            nextBtn.style.display = 'block';
        } else {
            showResults();
        }
    }

    function nextQuestion() {
        currentQuestionIndex++;
        displayQuestion();
    }
    
    function showResults(){
        quizEl.style.display = 'none';
        resultsEl.style.display = 'block';
        document.getElementById('score').textContent = `${currentQuestions.length} 問中 ${score} 問正解！`;
        
        let message = '';
        const percentage = score / currentQuestions.length;
        if(percentage === 1){
            message = '素晴らしい！全問正解です！';
        } else if (percentage >= 0.7){
            message = 'おしい！あと少しで完璧です！';
        } else if (percentage >= 0.5){
            message = 'よく頑張りました。復習して再挑戦してみましょう。';
        } else {
            message = 'まだまだ伸びしろがありますね！頑張りましょう。';
        }
        document.getElementById('feedback-message').textContent = message;
    }

    function shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }

</script>
</body>
</html>
